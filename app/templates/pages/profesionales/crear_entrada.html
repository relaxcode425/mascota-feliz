{% extends 'base/base.html' %}
{% block title %}Nueva Entrada{% endblock %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Nueva Entrada para {{ ficha.mascota.nombre }}</h2>
    <form method="post">
        {% csrf_token %}
        <div class="card mb-4">
            <div class="card-body">
                <div class="mb-3">
                    <label for="peso" class="form-label">Peso (kg)</label>
                    <input type="number" step="0.01" class="form-control" id="peso" name="peso" min="0" required>
                </div>
                <div class="mb-3">
                    <label for="descripcion" class="form-label">Motivo de la sesión</label>
                    <textarea class="form-control" id="descripcion" name="descripcion" rows="3" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="tratamiento" class="form-label">Tratamiento realizado</label>
                    <textarea class="form-control" id="tratamiento" name="tratamiento" rows="3"></textarea>
                </div>
                {% if user.tipo_usuario == 'veterinario' %}
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="tiene_receta" name="tiene_receta" onclick="toggleReceta()">
                    <label class="form-check-label" for="tiene_receta">
                        Incluir receta médica
                    </label>
                </div>
                <div id="receta_section" style="display:none;">
                    <div class="mb-3">
                        <label for="medicamentos" class="form-label">Medicamentos</label>
                        <textarea class="form-control" id="medicamentos" name="medicamentos" rows="2"></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="indicaciones_generales" class="form-label">Indicaciones generales</label>
                        <textarea class="form-control" id="indicaciones_generales" name="indicaciones_generales" rows="2"></textarea>
                    </div>
                </div>
                <script>
                    function toggleReceta() {
                        var recetaSection = document.getElementById('receta_section');
                        recetaSection.style.display = document.getElementById('tiene_receta').checked ? 'block' : 'none';
                    }
                </script>
                {% endif %}
            </div>
        </div>
        <button type="submit" class="btn btn-success">Guardar entrada</button>
    </form>
</div>
{% endblock %}